/*! angular-meteor-auth v1.0.2 */
!function(r,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.angularMeteorAuth=e():r.angularMeteorAuth=e()}(this,function(){return function(r){function e(n){if(t[n])return t[n].exports;var u=t[n]={exports:{},id:n,loaded:!1};return r[n].call(u.exports,u,u.exports,e),u.loaded=!0,u.exports}var t={};return e.m=r,e.c=t,e.p="",e(0)}([function(r,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var t="angular-meteor.auth";e["default"]=t,angular.module(t,["angular-meteor.mixer","angular-meteor.core","angular-meteor.view-model","angular-meteor.reactive"]).factory("$$Auth",["$Mixer","$log",function(r,e){function t(){var r=arguments.length<=0||void 0===arguments[0]?this:arguments[0];this.autorun(function(){r.currentUser=n.user(),r.currentUserId=n.userId(),r.isLoggingIn=n.loggingIn()})}var n=(Package["accounts-base"]||{}).Accounts;if(!n)throw Error("`angular-meteor.auth` module requires `accounts-base` package, please run `meteor add accounts-base` before use");var u={required:"AUTH_REQUIRED",forbidden:"FORBIDDEN"};return t.$awaitUser=function(e){var t=this;if(e=e?this.$bindToContext(r.caller,e):function(){return!0},!_.isFunction(e))throw Error("argument 1 must be a function");var n=this.$$defer(),o=this.autorun(function(r){if(!t.getReactively("isLoggingIn")){if(r.stop(),!t.currentUser)return t.$$afterFlush(n.reject,u.required);var o=e(t.currentUser);if(o===!0)return t.$$afterFlush(n.resolve,t.currentUser);var i=void 0;return i=_.isString(o)||o instanceof Error?o:u.forbidden,t.$$afterFlush(n.reject,i)}}),i=n.promise;return i.stop=o.stop.bind(o),i},t.$$afterFlush=function(r){var e;_.isString(r)&&(r=this[r]);for(var t=arguments.length,n=Array(t>1?t-1:0),u=1;t>u;u++)n[u-1]=arguments[u];return Tracker.afterFlush((e=r).bind.apply(e,[this].concat(n)))},t.$waitForUser=function(){return this.$awaitUser()["catch"](function(r){e.debug("$awaitUser",r)})},t.$requireUser=function(){return this.$awaitUser()},t.$requireValidUser=function(){return this.$awaitUser.apply(this,arguments)},t}]).service("$auth",["$rootScope","$$Auth",function(r,e){var t=this;_.keys(e).forEach(function(e){var n=e.substr(1);t[n]=function(){return r[e].apply(r,arguments)}})}]).run(["$Mixer","$$Auth",function(r,e){r.mixin(e)}]),r.exports=e["default"]}])});
//# sourceMappingURL=angular-meteor-auth.min.js.map